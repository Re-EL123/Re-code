<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Re-Code | Re-EL’s Advanced Coding AI</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<!-- React + Babel CDN -->
<script src="https://unpkg.com/react@18/umd/react.development.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

<!-- Puter JS -->
<script src="https://js.puter.com/v2/"></script>

<!-- Lucide Icons -->
<script src="https://unpkg.com/lucide@latest"></script>

<!-- Monaco Editor -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/monaco-editor@0.43.0/min/vs/editor/editor.main.css" />
<script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.43.0/min/vs/loader.js"></script>

<!-- Highlight.js -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/atom-one-dark.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/cpp.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/csharp.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/java.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/typescript.min.js"></script>

<style>
* { box-sizing: border-box; }
body { margin:0; font-family: Inter, system-ui, sans-serif; background: radial-gradient(circle at top, #0b0f1a, #000); color: #fff; }
.app { max-width: 1200px; margin: auto; padding: 30px; animation: fadeIn 0.8s ease; }
@keyframes fadeIn { from {opacity:0; transform:translateY(10px);} to{opacity:1; transform:translateY(0);} }
header { display:flex; align-items:center; justify-content:space-between; margin-bottom:20px; }
.brand { display:flex; align-items:center; gap:12px; font-size:1.5rem; font-weight:700; }
.brand span { color:#6ef3c5; }
.panel { background: rgba(255,255,255,0.05); border-radius:16px; padding:20px; backdrop-filter: blur(10px); box-shadow:0 0 40px rgba(0,0,0,0.4); margin-bottom:20px; }
textarea { width:100%; height:120px; background:#020617; border:1px solid #1e293b; color:#e5e7eb; border-radius:12px; padding:15px; resize:none; }
.actions { display:flex; justify-content:space-between; margin-top:12px; }
button { background: linear-gradient(135deg,#6ef3c5,#4ade80); border:none; color:#000; padding:12px 18px; border-radius:12px; font-weight:600; cursor:pointer; display:flex; gap:8px; }
.output { margin-top:20px; background:#020617; border-radius:16px; padding:20px; min-height:300px; border:1px solid #1e293b; }
#editor-container { height:400px; border-radius:12px; overflow:hidden; border:1px solid #1e293b; }
.cursor { display:inline-block; width:8px; background:#6ef3c5; animation:blink 1s infinite; }
@keyframes blink { 50% { opacity:0; } }
footer { margin-top:30px; text-align:center; opacity:0.6; }
</style>
</head>

<body>
<div id="root"></div>

<script type="text/babel">
const { useState, useEffect, useRef } = React;

function detectLanguage(code){
  if(code.trim().startsWith("<")) return "html";
  if(/import|export|function|const|let/.test(code)) return "javascript";
  if(/interface|type\s+\w+/.test(code)) return "typescript";
  if(/#include|std::/.test(code)) return "cpp";
  if(/using System;|namespace/.test(code)) return "csharp";
  if(/public class|static void main/.test(code)) return "java";
  if(/def |print\(/.test(code)) return "python";
  return "plaintext";
}

function cleanCode(raw){
  return raw
    .replace(/```[a-zA-Z]*/g,"")
    .replace(/```/g,"")
    .trim();
}

function App(){
  const [prompt,setPrompt]=useState("");
  const [code,setCode]=useState("");
  const [loading,setLoading]=useState(false);
  const editorRef=useRef(null);

  useEffect(()=>{
    lucide.createIcons();
    require.config({paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.43.0/min/vs"}});
    require(["vs/editor/editor.main"],()=>{
      editorRef.current=monaco.editor.create(document.getElementById("editor-container"),{
        value:"",
        language:"javascript",
        theme:"vs-dark",
        automaticLayout:true
      });
    });
  },[]);

  async function generateCode(){
    setLoading(true);
    setCode("");
    const systemPrompt="Return strictly code only. No markdown. No backticks. No text.";

    const response=await puter.ai.chat(
      [{role:"system",content:systemPrompt},{role:"user",content:prompt}],
      {model:"claude-sonnet-4-5",stream:true}
    );

    let buffer="";
    for await(const part of response){
      buffer+=part?.text||"";
      const cleaned=cleanCode(buffer);
      const lang=detectLanguage(cleaned);
      setCode(cleaned);
      editorRef.current.setValue(cleaned);
      monaco.editor.setModelLanguage(editorRef.current.getModel(),lang);
    }

    setTimeout(()=>hljs.highlightAll(),200);
    setLoading(false);
  }

  function copyAll(){
    navigator.clipboard.writeText(code);
    alert("Copied!");
  }

  return (
    <div className="app">
      <header>
        <div className="brand"><i data-lucide="code-2"></i> Re-Code <span>AI</span></div>
        <div>Claude Sonnet</div>
      </header>

      <div className="panel">
        <textarea value={prompt} onChange={e=>setPrompt(e.target.value)} placeholder="Describe the code you want…" />
        <div className="actions">
          <button onClick={generateCode}>Generate</button>
          <button onClick={copyAll}>Copy Output</button>
        </div>
      </div>

      <div id="editor-container"></div>

      <div className="output">
        <pre><code>{code}</code>{loading && <span className="cursor"></span>}</pre>
      </div>

      <footer>© Re-EL • Re-Code Advanced AI</footer>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<App/>);
</script>
</body>
</html>
